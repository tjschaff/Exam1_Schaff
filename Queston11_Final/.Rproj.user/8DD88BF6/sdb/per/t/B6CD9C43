{
    "contents" : "---\ntitle: \"QUESTION11\"\nauthor: \"Trevor Schaff\"\ndate: \"November 5, 2015\"\noutput: html_document\n---\n\n```{r reading in data}\ndata_exon <- read.csv(\"data/Homo_sapiens.GRCh38.82.abinitio_exons.gtf\", sep=\"\\t\")\ndata_transcript <- read.csv(\"data/Homo_sapiens.GRCh38.82.abinitio_transcripts.gtf\", sep=\"\\t\")\nnames(data_exon)[1]<-\"chromosome\"\nnames(data_exon)[4]<-\"start\"\nnames(data_exon)[5]<-\"end\"\n\nnames(data_transcript)[1]<-\"chromosome\"\nnames(data_transcript)[4]<-\"start\"\nnames(data_transcript)[5]<-\"end\"\n\n```\n\n```{r making new length column}\ndata_exon$length <- (data_exon$end - data_exon$start)\ndata_transcript$length <- (data_transcript$end - data_transcript$start)\n\ndata_exon_clean <- data_exon[data_exon$chromosome == \"1\" | data_exon$chromosome == \"2\"| data_exon$chromosome == \"3\" | data_exon$chromosome == \"4\" | data_exon$chromosome == \"5\" | data_exon$chromosome == \"6\" | data_exon$chromosome == \"7\" | data_exon$chromosome == \"8\" | data_exon$chromosome == \"9\" | data_exon$chromosome == \"10\" | data_exon$chromosome == \"11\" | data_exon$chromosome == \"12\" | data_exon$chromosome == \"13\" | data_exon$chromosome == \"14\" | data_exon$chromosome == \"15\" | data_exon$chromosome == \"16\" | data_exon$chromosome == \"17\" | data_exon$chromosome == \"18\" | data_exon$chromosome == \"19\" | data_exon$chromosome == \"20\" | data_exon$chromosome == \"21\" | data_exon$chromosome == \"22\" | data_exon$chromosome == \"X\" | data_exon$chromosome == \"Y\",]\n\ndata_transcript_clean <- data_transcript[data_transcript$chromosome == \"1\" | data_transcript$chromosome == \"2\"| data_transcript$chromosome == \"3\" | data_transcript$chromosome == \"4\" | data_transcript$chromosome == \"5\" | data_transcript$chromosome == \"6\" | data_transcript$chromosome == \"7\" | data_transcript$chromosome == \"8\" | data_transcript$chromosome == \"9\" | data_transcript$chromosome == \"10\" | data_transcript$chromosome == \"11\" | data_transcript$chromosome == \"12\" | data_transcript$chromosome == \"13\" | data_transcript$chromosome == \"14\" | data_transcript$chromosome == \"15\" | data_transcript$chromosome == \"16\" | data_transcript$chromosome == \"17\" | data_transcript$chromosome == \"18\" | data_transcript$chromosome == \"19\" | data_transcript$chromosome == \"20\" | data_transcript$chromosome == \"21\" | data_transcript$chromosome == \"22\" | data_transcript$chromosome == \"X\" | data_transcript$chromosome == \"Y\",]\n\n#install.packages(\"plyr\")\nlibrary(plyr)\nstd <- function(x) sd(x)/sqrt(length(x))\nexon_data <- ddply(data_exon_clean,~chromosome,summarise,mean=format(round(mean(length),2)),sd=format(round(sd(length),2)),se=format(round(std(length),2)))\ntranscript_data <- ddply(data_transcript_clean,~chromosome,summarise,mean=format(round(mean(length),2)),sd=format(round(sd(length),2)),se=format(round(std(length),2)))\n\nnames(exon_data)[3]<-\"sd_exon\"\nnames(exon_data)[4]<-\"se_exon\"\n\nnames(transcript_data)[3]<-\"sd_transcript\"\nnames(transcript_data)[4]<-\"se_transcript\"\n\nnames(exon_data)[2]<-\"exon_length\"\nnames(transcript_data)[2]<-\"transcript_length\"\n\nrecom<-merge(exon_data, transcript_data, by.x=\"chromosome\", by.y=\"chromosome\")\n\nwrite.table(recom, sep='\\t')\n\n```\n\n```{r histograms}\n#install.packages(\"ggplot2\")\nlibrary(ggplot2)\nx_chrom <- subset(data_exon_clean, chromosome == \"X\", c(chromosome, length))\n\ny_chrom <- subset(data_exon_clean, chromosome == \"Y\", c(chromosome, length))\n\nhist(x_chrom$length)\nhist(y_chrom$length)\n```\n\n```{r chrom length vs exon length}\nchrlengths<- matrix(c(248956422,242193529,198295559,190214555,181538259,170805979,159345973,145138636,138394717,133797422,135086622,133275309,114364328,107043718,101991189,90338345,83257441,80373285,58617616,64444167,46709983,50818468,156040895,57227415))\n\nnames(chrlengths)[1]<-\"chrlengths\"\n\nchrcols <- matrix(c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,\"X\",\"Y\"))\n\nlengths_with_chrs<-transform(chrlengths, new.col = chrcols)\nnames(lengths_with_chrs)[1]<-\"chr_length\"\nnames(lengths_with_chrs)[2]<-\"chromosome\"\naverage_exon_lengths <-matrix(c(171.81,170.24,167.44,180.71,179.45,175.64,175.3,172.36,174.12,172.48,178.05,166.45,176.77,177.29,172.85,172.86,171.88,174.18,196.75,168.64,175.69,176.25,193.39,191.06))\n\nfinal_dataset <-transform(lengths_with_chrs, new.col = average_exon_lengths)\nnames(final_dataset)[1]<-\"chr_length\"\nnames(final_dataset)[3]<-\"mean_exon_length\"\n\ncor(final_dataset$chr_length, final_dataset$mean_exon_length)\nplot(final_dataset$chr_length, final_dataset$mean_exon_length)\n\n\n```\n\n\n\nThere is not a significant relationship between the length of a chromosome and its corresponding mean exon length. The correlation coefficient is -0.25.\n\n\n",
    "created" : 1447095368747.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3571838483",
    "id" : "B6CD9C43",
    "lastKnownWriteTime" : 1447084000,
    "path" : "~/Desktop/Queston11_Final/Schaff Question11(2).Rmd",
    "project_path" : "Schaff Question11(2).Rmd",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_markdown"
}